<!DOCTYPE html><html lang="zh-CN" id="theme-mode-light"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="李明元"><title>Shell scripts for turning Proxy server on/off · 大明哥的博客</title><meta name="description" content="Scripts for turning Proxy server on/off::

/etc/environment contains only one line i.e. ‘$PATH:…’. And nothing else.

So! If you want to automate the "><meta name="keywords" content="大明哥,李明元的博客,李明元,博客,blog,Hexo,HTML,CSS,android,Linux"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="https://avatars.githubusercontent.com/u/17492753?v=4" style="width:127px;border-radius:50%"><h3 title=""><a href="/">大明哥的博客</a></h3><div class="description"><p id="yiyan">...</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="http://weibo.com/https://weibo.com/u/5229973867"><i class="fa fa-weibo"></i></a></li><li><a target="_blank" rel="noopener" href="http://github.com/https://github.com/yuan1"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a target="_blank" rel="noopener" href="https://www.caicai.me"> CaiCai </a><span>&</span><a target="_blank" rel="noopener" href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div><div class="by_farbox"><span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"> </span><span>次</span></span></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">关于</a></li></div><div class="information"><div class="nav_right_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"></a></li><li><a class="fa fa-sun-o" onclick="darkLightToggle()"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Shell scripts for turning Proxy server on/off</a></h3></div><div class="post-content"><p>Scripts for turning Proxy server on/off::</p>
<ol>
<li>/etc/environment contains only one line i.e. ‘$PATH:…’. And nothing else.</li>
</ol>
<p>So! If you want to automate the process of turning proxy on and off without having to type allot. you can make two executable shell scripts proxyon.sh and proxyoff.sh as:</p>
<p><a target="_blank" rel="noopener" href="http://gofile.me/3BPQ1/ZnpvWGA3E">proxyon.sh</a> :  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $(<span class="built_in">id</span> -u) -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;This script must be run as root&quot;</span>;</span><br><span class="line">  <span class="built_in">exit</span> 1;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -eq 2 ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">  grep PATH /etc/environment &gt; lol.t;</span><br><span class="line">  <span class="built_in">printf</span> \</span><br><span class="line">  <span class="string">&quot;http_proxy=http://<span class="variable">$1</span>:<span class="variable">$2</span>/\n\</span></span><br><span class="line"><span class="string">  https_proxy=http://<span class="variable">$1</span>:<span class="variable">$2</span>/\n\</span></span><br><span class="line"><span class="string">  ftp_proxy=http://<span class="variable">$1</span>:<span class="variable">$2</span>/\n\</span></span><br><span class="line"><span class="string">  no_proxy=\&quot;localhost,127.0.0.1,localaddress,.localdomain.com\&quot;\n\</span></span><br><span class="line"><span class="string">  HTTP_PROXY=http://<span class="variable">$1</span>:<span class="variable">$2</span>/\n\</span></span><br><span class="line"><span class="string">  HTTPS_PROXY=http://<span class="variable">$1</span>:<span class="variable">$2</span>/\n\</span></span><br><span class="line"><span class="string">  FTP_PROXY=http://<span class="variable">$1</span>:<span class="variable">$2</span>/\n\</span></span><br><span class="line"><span class="string">  NO_PROXY=\&quot;localhost,127.0.0.1,localaddress,.localdomain.com\&quot;\n&quot;</span> &gt;&gt; lol.t;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cat</span> lol.t &gt; /etc/environment;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span> \</span><br><span class="line">  <span class="string">&quot;Acquire::http::proxy \&quot;http://<span class="variable">$1</span>:<span class="variable">$2</span>/\&quot;;\n\</span></span><br><span class="line"><span class="string">  Acquire::ftp::proxy \&quot;ftp://<span class="variable">$1</span>:<span class="variable">$2</span>/\&quot;;\n\</span></span><br><span class="line"><span class="string">  Acquire::https::proxy \&quot;https://<span class="variable">$1</span>:<span class="variable">$2</span>/\&quot;;\n&quot;</span> &gt; /etc/apt/apt.conf.d/95proxies;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">rm</span> -rf lol.t;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span> <span class="string">&quot;Usage <span class="variable">$0</span> &lt;proxy_ip&gt; &lt;proxy_port&gt;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://gofile.me/3BPQ1/zkocVRb1s">proxyoff.sh:</a>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $(<span class="built_in">id</span> -u) -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;This script must be run as root&quot;</span>;</span><br><span class="line">  <span class="built_in">exit</span> 1;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">grep PATH /etc/environment &gt; lol.t;</span><br><span class="line"><span class="built_in">cat</span> lol.t &gt; /etc/environment;</span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> -rf lol.t;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>How to use: Once you have made these scripts, make them executable, you may keep them anywhere you like. To turn on proxy all you have to do is go to the directory containing the ‘proxyon.sh’ script and then you need to type sudo ./proxyon.sh {host} {port}. As an example consider this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ./proxyon.sh 10.2.20.17 8080</span><br><span class="line">OR</span><br><span class="line">$ sudo ./proxyon.sh myproxy.server.com 8080</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Where ‘10.2.20.17’ is the proxy server’s IP - you can also type something like myproxy.server.com - and ‘8080’ is the port. After that just log out and login to your account, to make sure that everything is set. You can start using the internet or whatever then. And when you want to turn the proxy off, go to the directory containing ‘proxyoff.sh’ and type:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ./proxyoff.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>This will unset all of your proxies. Now logout and login again to switch to normal mode.</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2022-11-10</span><i class="fa fa-comment-o"></i><a href="/posts/7b50915a.html#comments">评论</a><i class="fa fa-tag"></i><a class="tag" href="/tags/Linux/" title="Linux">Linux </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:;" onclick="javascript:join_favorite()"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/posts/1e37c9d7.html" title="MYSQL-ERROR-1862">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/posts/51bf373e.html" title="停止并删除所有的docker容器和镜像">下一篇</a></li></ul></div><a id="comments"></a><div id="gitalk_container" style="margin:0 30px;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
    title: "Shell scripts for turning Proxy server on/off",
    clientID: "cb160053da3741b7f5ff",
    clientSecret: "a88a60c126a9c12e1163d5b4d8d1c4622a60ea0f",
    repo: "yuan1.github.io",
    owner: "yuan1",
    admin: ["yuan1"],
    id: location.pathname.slice(0, 50),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
})
gitalk.render("gitalk_container")</script></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/script.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script></body></html>